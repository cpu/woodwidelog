<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Slow Moving - Wood Wide Log</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Butterfly. Blightmud. Bad movies."><meta property="og:image" content><meta property="og:url" content="https://log.woodweb.ca/2022/10/slow-moving/"><meta property="og:site_name" content="Wood Wide Log"><meta property="og:title" content="Slow Moving"><meta property="og:description" content="Butterfly. Blightmud. Bad movies."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-15T08:00:00-04:00"><meta property="article:modified_time" content="2022-10-15T08:00:00-04:00"><meta property="og:image" content="https://log.woodweb.ca/2022/10/slow-moving/feature.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://log.woodweb.ca/2022/10/slow-moving/feature.jpg"><meta name=twitter:title content="Slow Moving"><meta name=twitter:description content="Butterfly. Blightmud. Bad movies."><script src=https://log.woodweb.ca/js/feather.min.js></script><link href=https://log.woodweb.ca/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://log.woodweb.ca/css/main.5cebd7d4fb2b97856af8d32a6def16164fcf7d844e98e236fcb3559655020373.css><link rel=stylesheet type=text/css href=https://log.woodweb.ca/css/custom.d10d882a0feb2833d6bb41c11b088fd0710c01566f5092017beb42fa48bc7762.css></head><body><div class=content><header><div class=main><a href=https://log.woodweb.ca/>Wood Wide Log</a></div><nav><a href=/>Log</a>
<a href=/articles>Articles</a>
<a href=/posts>Archive</a>
<a href=/about>About</a></nav></header><main><article><div class=title><h1 class=title>Slow Moving</h1><div class=meta>Posted on Oct 15, 2022</div></div><section class=body><p>Its been hard to marshal energy to get up to much. The combination of changing
weather, a birthday, and Thanksgiving in short succession makes me a bit of
a slug. Rather than get too hung up on it I&rsquo;ve been embracing &#x1f383;
<em>Spooky October vibes</em> &#x1f383; and watching a lot of horror movies
(<em>some good, most bad</em>).</p><p><img src=./monarch.jpg alt=Monarch></p><h1 id=lately>Lately</h1><p>Despite being a slug I did find some time for a small project that needs a bit
of backstory.</p><h2 id=blightmud>Blightmud</h2><h3 id=the-backstory>The Backstory</h3><p>Most <a href=https://en.wikipedia.org/wiki/MUD>MUD</a>s are played over Telnet, but using a vanilla Telnet client makes for
a miserable experience. Serious enjoyment requires niceties like scripting and
support for extra protocol additions like <a href=https://nexus.ironrealms.com/GMCP>GMCP</a>, TLS, and <a href=https://www.rfc-editor.org/rfc/rfc2066>charset
negotiation</a>. Some folks prefer graphical clients, and excellent free software
like <a href=https://www.mudlet.org/>Mudlet</a> sprung up in recent years to offer a polished, multi-platform,
graphical MUD client perfect for those people.</p><p>Personally I&rsquo;ve always preferred terminal clients because of how nicely they
work over SSH paired with <a href=https://github.com/tmux/tmux>Tmux</a>. Historically my MUD client of choice (<em>for 15+
years!</em>) has been <a href=https://tinyfugue.sourceforge.net/>TinyFugue</a>. Unfortunately, its development is fragmented, it
uses a custom scripting language (<em>ugh</em>) and it&rsquo;s implemented in C (<em>ugh++</em>).</p><p>Thankfully within the last year I discovered an excellent alternative:
<a href=https://github.com/blightmud/blightmud>Blightmud</a>. It&rsquo;s actively developed, supports TLS, uses Lua for its
scripting language, and is implemented in Rust. What&rsquo;s not to love?</p><h3 id=in-a-bind>In A Bind</h3><p>Writing <a href=https://github.com/NixOS/nixpkgs/commit/ae1bee344a09129db2c13d5564e632934b68cdaf>an initial NixPkgs derivation</a> turned out to be
a little bit challenging because of Blightmud&rsquo;s optional text-to-speech
accessibility feature (<em>MUDs are quite popular with people that have visual
impairments</em>). Getting this working requires customizing <a href=https://rust-lang.github.io/rust-bindgen/>rust-bindgen</a>
and the <code>LIBCLANG_PATH</code> so that the Cargo build of the <code>speech-dispatcher-sys</code>
crate can find the <code>speechd</code> libraries it requires. At the time I wrote the
first derivation I found <a href=https://twitter.com/a_hoverbear>Hoverbear</a>&rsquo;s <a href=https://hoverbear.org/blog/rust-bindgen-in-nix/>blog post on the
subject</a> and it made this 100x easier to figure out. &#x1f9b8;</p><p>The derivation has remained mostly unchanged until last week when I discovered
a nice way to clean up all that extra configuration. It turns out the extra
<code>preBuild</code> and path fiddling to get <code>bindgen</code> configured can be replaced by
a <a href=https://github.com/NixOS/nixpkgs/blob/master/doc/languages-frameworks/rust.section.md#hooks-hooks>hook</a> that was added to the shared Rust platform framework in
~Feb: <code>rustPlatform.bindgenHook</code>.</p><p>A quick <a href=https://github.com/NixOS/nixpkgs/pull/194525>cleanup PR</a> later and the <a href=https://github.com/NixOS/nixpkgs/blob/deed43a7257ea861e00d627b98f0e62d2072d790/pkgs/games/blightmud/default.nix>derivation</a> is now much
shorter and a lot less custom. It felt good to cut out that complexity and it
was interesting to read through the platform framework implementation of the
hook (<em>see <a href=https://github.com/NixOS/nixpkgs/blob/b784c5ae63dd288375af1b4d37b8a27dd8061887/pkgs/build-support/rust/hooks/default.nix#L94-L101>here</a>, <a href=https://github.com/NixOS/nixpkgs/blob/b784c5ae63dd288375af1b4d37b8a27dd8061887/pkgs/build-support/rust/hooks/rust-bindgen-hook.sh>here</a>, and <a href=https://github.com/NixOS/nixpkgs/blob/8ff7b290e6dd47d7ed24c6d156ba60fc3c83f100/pkgs/development/tools/rust/bindgen/wrapper.sh>here</a></em>) to
compare to the approach I used.</p><h1 id=thinking-about>Thinking about</h1><p><img src=./choppingmall.jpg alt="Chopping Mall"></p><ul><li><a href=https://www.imdb.com/title/tt0090837/>Chopping Mall (1986)</a>. Look at that title font! Truly one of the
least intimidating killer robot designs you could imagine. It&rsquo;s a flop of
a movie, but I really dig the late 80s mall setting.</li><li><a href=https://asawicki.info/articles/Hello_world_under_the_microscope.php5>Hello World under the microscope</a>. This work makes other &ldquo;deep
dives&rdquo; look awfully shallow in comparison. Layer after layer of abstractions
peeled away. &#x1f52c;</li><li><a href=https://lwn.net/SubscriberLink/910435/8edb2c6f835f960a/>Fingerprinting systems with TCP source-port selection</a>.
A really clever bit of research. It&rsquo;s interesting to see a defensive mechanism
(<em><a href=https://www.rfc-editor.org/rfc/rfc6056>RFC 6056</a> source port randomization</em>) enabling other new attacks.</li></ul><h1 id=until-next-time>Until next time</h1><p>&#x1f916;&#x1f4ac; <em>THANK YOU, HAVE A NICE DAY</em></p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/7PsITAWy5C0?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div></section><div class=post-tags></div></article></main><footer><div style=display:flex><a class=soc href=https://log.woodweb.ca/index.xml title=RSS><i data-feather=rss></i></a>
<a class=border></a><a class=soc href=https://github.com/cpu/woodwidelog title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/cpu/ title=Twitter><i data-feather=twitter></i></a>
<a class=border></a></div><div class=footer-info>2024 Daniel McCarney</div></footer><script>feather.replace()</script></div></body></html>